
# Project 1: System Call

이 프로젝트는 xv6 운영체제에 새로운 시스템 콜을 구현하는 것을 목표로 합니다.

---

## 목차

- [프로젝트 개요](#프로젝트-개요)
- [시스템 콜 개념](#시스템-콜-개념)
- [Trap 처리 과정](#trap-처리-과정)
- [새 시스템 콜 만들기](#새-시스템-콜-만들기)
- [테스트 프로그램 작성](#테스트-프로그램-작성)
- [참고 자료](#참고-자료)

---

## 프로젝트 개요

이 프로젝트의 목표는 xv6 운영체제에서 `getreadcount()`라는 새로운 시스템 콜을 추가하는 것입니다. 이 시스템 콜은 `read()` 시스템 콜이 호출된 횟수를 반환합니다.



## 시스템 콜 개념

시스템 콜은 사용자 공간에서 커널에 접근하기 위한 인터페이스입니다. 사용자 프로그램이 시스템 리소스에 접근하려고 할 때 시스템 콜을 사용합니다.



## Trap 처리 과정

xv6에서 Trap 처리 과정은 다음과 같습니다:

1. **사용자 모드에서 시스템 콜 호출**: 예를 들어, `kill()` 시스템 콜을 호출하면 `movl $6, %eax; int $64` 코드가 실행됩니다.
2. **Trap 핸들러 실행**: 커널 모드로 전환되며, `trap()` 함수가 호출됩니다.
3. **시스템 콜 테이블 확인**: `syscall()` 함수가 적절한 시스템 콜 핸들러를 호출합니다.
4. **커널 모드에서 작업 수행 후 복귀**: 작업 완료 후 사용자 모드로 돌아옵니다.



## 새 시스템 콜 만들기

`getreadcount()` 시스템 콜을 추가하는 단계는 다음과 같습니다:

1. **라이브러리 루틴 선언**: `user.h` 파일에 `int getreadcount(void);` 선언 추가.
2. **라이브러리 루틴 정의**: `usys.S` 파일에 `getreadcount` 루틴 정의.
3. **시스템 콜 테이블 업데이트**: `syscall.c` 파일의 시스템 콜 테이블에 `getreadcount` 추가.
4. **시스템 콜 핸들러 구현**: `sysproc.c` 파일에 `sys_getreadcount` 함수 구현.



## 테스트 프로그램 작성

`getreadcount()` 시스템 콜을 테스트하기 위해 사용자 프로그램 `readcount.c`를 작성합니다. `Makefile`에 `readcount` 프로그램을 추가하여 xv6에서 실행 가능하게 만듭니다.


## 참고 자료

- xv6 소스 코드: [GitHub 링크](https://github.com/mit-pdos/xv6-public)
- xv6 해설서: [xv6 commentary PDF](https://pdos.csail.mit.edu/6.828/2018/xv6/book-rev11.pdf)
- xv6 관련 참고서적: [xv6 source booklet PDF](https://pdos.csail.mit.edu/6.828/2018/xv6/xv6-rev11.pdf)


